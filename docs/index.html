<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lofi Study Room</title>
    <!-- ‚úÖ CSS stays the same since index.css is in docs/ -->
    <base href=".">
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <!-- Home Page -->
    <div class="page active" id="homePage">
      <div class="home-content">
        <h1 class="title">Study Room</h1>
        <p class="subtitle">It's time to lock in</p>

        <!-- Timer Navigation -->
        <button class="main-timer-btn" onclick="showPage('timer')">
          Go To Timer
        </button>

        <!-- üîë Email/Password Auth Form -->
        <div class="auth-container" style="margin-top: 20px">
          <input type="email" id="email" placeholder="Email" />
          <input type="password" id="password" placeholder="Password" />
          <button id="signup">Sign Up</button>
          <button id="login">Log In</button>
          <button id="logout" style="display: none">Log Out</button>
          <p
            id="current-user"
            style="margin-top: 8px; color: #ccc; font-size: 0.9rem"
          ></p>
        </div>
      </div>
    </div>

    <!-- Timer Page -->
    <div class="page" id="timerPage">
      <button class="back-btn" onclick="showPage('home')">‚Üê back</button>
      <div class="timer-content">
        <h2
          style="
            font-size: 2rem;
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.8);
          "
        >
          focus session
        </h2>
        <div class="timer-display" id="timerDisplay">25:00</div>
        <div class="timer-status" id="timerStatus">ready to focus</div>
        <div class="timer-controls">
          <button class="timer-btn" id="startBtn">start</button>
          <button class="timer-btn" id="pauseBtn">pause</button>
          <button class="timer-btn" id="resetBtn">reset</button>
        </div>
      </div>
    </div>

    <!-- Study Buddy Page -->
    <div class="page" id="buddyPage">
      <a href="../src/buddy.html" class="side-nav right-nav">
        <span class="nav-text">Study Buddies</span>
        <span class="nav-arrow">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="32px"
            viewBox="0 -960 960 960"
            width="32px"
            fill="#e3e3e3"
          >
            <path
              d="m560-242-43-42 168-168H160v-60h525L516-681l43-42 241 241-240 240Z"
            />
          </svg>
        </span>
      </a>
    </div>

    <!-- Study Spots Page -->
    <div class="page" id="spotsPage">
        <button class="side-nav-container">
            <a href="../src/spots.html" class="side-nav left-nav">
                <span class="nav-text">Study Places</span>
                <span class="nav-arrow">
                    <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="48px"
                    viewBox="0 -960 960 960"
                    width="48px"
                    fill="#e3e3e3"
                    >
                    <path>
                    d="M400-240 160-480l241-241 43 42-169 169h526v60H275l168 168-43 42Z"
                    />
                </svg>
                </span>
            </a>
        </button>
    </div>

    <!-- Timer Script -->
    <script>
      function showPage(pageName) {
        document
          .querySelectorAll(".page")
          .forEach((page) => page.classList.remove("active"));
        document.getElementById(pageName + "Page").classList.add("active");
      }

      let timerState = {
        minutes: 25,
        seconds: 0,
        isRunning: false,
        totalTime: 1500,
        currentTime: 1500,
      };
      let timerInterval;

      function updateTimerDisplay() {
        const display = document.getElementById("timerDisplay");
        const status = document.getElementById("timerStatus");
        display.textContent = `${timerState.minutes
          .toString()
          .padStart(2, "0")}:${timerState.seconds.toString().padStart(2, "0")}`;
        status.textContent = timerState.isRunning
          ? "deep focus mode"
          : timerState.currentTime === timerState.totalTime
          ? "ready to focus"
          : "paused";
      }

      function startTimer() {
        if (
          !timerState.isRunning &&
          (timerState.minutes > 0 || timerState.seconds > 0)
        ) {
          timerState.isRunning = true;
          timerInterval = setInterval(() => {
            if (timerState.seconds === 0) {
              if (timerState.minutes === 0) {
                timerState.isRunning = false;
                clearInterval(timerInterval);
                document.getElementById("timerStatus").textContent =
                  "session complete! ‚ú®";
                return;
              }
              timerState.minutes--;
              timerState.seconds = 59;
            } else {
              timerState.seconds--;
            }
            timerState.currentTime =
              timerState.minutes * 60 + timerState.seconds;
            updateTimerDisplay();
          }, 1000);
          updateTimerDisplay();
        }
      }

      function pauseTimer() {
        timerState.isRunning = false;
        clearInterval(timerInterval);
        updateTimerDisplay();
      }
      function resetTimer() {
        timerState.isRunning = false;
        timerState.minutes = 25;
        timerState.seconds = 0;
        timerState.currentTime = timerState.totalTime;
        clearInterval(timerInterval);
        updateTimerDisplay();
      }

      document.getElementById("startBtn").addEventListener("click", startTimer);
      document.getElementById("pauseBtn").addEventListener("click", pauseTimer);
      document.getElementById("resetBtn").addEventListener("click", resetTimer);

      updateTimerDisplay();
    </script>
    <script type="module" src="../src/module/index.js"></script>
    
    <!-- ‚úÖ Load Firebase Auth Logic -->
    <script type="module" src="../src/module/auth.js"></script>
  </body>
</html>
